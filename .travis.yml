language: objective-c
osx_image: xcode7.2
podfile: Podfile
cache: cocoapods
sudo: true
env:
  global:
  - LC_CTYPE=en_US.UTF-8
  - LANG=en_US.UTF-8
  - PROFILE_NAME="Travis Provisioning Profile"
  - 'DEVELOPER_NAME="iPhone Developer: Clement Padovani (L4ZPL65Y4M)"'
  
before_script:
    - echo $ENCRYPTION_SECRET
    - echo "$ENCRYPTION_SECRET"
    - openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in Vendor/Travis_Provisioning_Profile.mobileprovision.enc -d -a -out Vendor/Travis_Provisioning_Profile.mobileprovision
    - openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in Vendor/Certificate.cer.enc -d -a -out Vendor/Certificate.cer
    - openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in Vendor/key.p12.enc -d -a -out Vendor/key.p12
    - ./Vendor/add-key.sh

script:
    - xctool "build test -sdk iphonesimulator9.2 -destination 'platform=iOS Simulator,name=iPhone5s,OS=9.2'"

after_script:
    - ./Vendor/remove-key.sh
